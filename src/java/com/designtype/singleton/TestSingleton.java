package com.designtype.singleton;
/**
 * ???:2019??2??14??
 * @author pefuxc
 *
 */
public class TestSingleton {

	private volatile TestSingleton aTestSingleton=null;
	
	private static int a=0;
	
	static class singleton{
		private static final TestSingleton aLast=new TestSingleton();
	}
	
	public TestSingleton getTestSingleton(){
		if(aTestSingleton == null){
			synchronized (TestSingleton.class) {
				return singleton.aLast;
			}
		}
		return aTestSingleton;
	}
	
	
	public static void main(String[] args) {
		
//		for (int i = 0; i <100; i++) {
//			SingletonThread aSingletonThread=new SingletonThread();
//			Thread aThread=new Thread(aSingletonThread);
//			aThread.setName("???"+i);
//			aThread.start();
//		}
		SingletonThread aSingletonThread=new SingletonThread();
		Thread aThread=new Thread(aSingletonThread);
		aThread.setName("???"+1);
		aThread.start();
		SingletonThread aSingletonThread1=new SingletonThread();
		Thread aThread2=new Thread(aSingletonThread1);
		aThread2.setName("???"+2);
		aThread2.start();
		
		SingletonThread aSingletonThread2=new SingletonThread();
		Thread aThread3=new Thread(aSingletonThread2);
		aThread3.setName("???"+3);
		aThread3.start();
	}
}

class SingletonThread implements Runnable {

	@Override
	public void run() {
		System.out.println(Thread.currentThread().getName()+"   :"+SingletonHungry.getSingletonHungry().hashCode());
	}
	
}

/**
 * ???????????
 * ???:2019??2??14??
 * @author pefuxc
 *
 */
class Singleton {

	static class singleton{
		//????final ??????????????   ??????  singleton
		private static final Singleton aLast=new Singleton();
		
		//?????  ???????????????????????????????? singleton  ????????о??????????е????
		private static final String a="1";
	}
	
	public static Singleton getTestSingleton(){
		return singleton.aLast;
	}
}

/**
 * ?????  ?????? ?????????Ч?????
 * ???:2019??2??14??
 * @author pefuxc
 *
 */
class SingletonLanKong{
	/**
	 * ?????? volatile ??  ?????jvm?????????????????  
	 * 
	 * ????????? jvm ???????
	 * 1.?  ????????????
	 * 2.????? ???????
	 * 3. ??????? ?????????
	 */
	private static volatile SingletonLanKong aSingletonLanKong=null;
	private  SingletonLanKong(){
		
	}
	public synchronized static SingletonLanKong getSingletonLanKong(){
		if(aSingletonLanKong==null){
			aSingletonLanKong=new SingletonLanKong();
		}
		return aSingletonLanKong;
	}
}

/**
 * ?????  ??????  ??????? ????????????
 * ???:2019??2??14??
 * @author pefuxc
 *
 */
class SingletonHungry{
	//???????  ???????????????  ???????????????????????????????
	private static SingletonHungry aSingletonHungry=new SingletonHungry();
	public static SingletonHungry getSingletonHungry(){
		if(aSingletonHungry==null){
			return aSingletonHungry;
		}
		return aSingletonHungry;
	}
}

